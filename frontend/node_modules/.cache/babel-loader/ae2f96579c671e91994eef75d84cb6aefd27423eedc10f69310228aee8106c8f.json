{"ast":null,"code":"var _jsxFileName = \"/home/oscar/M\\xFAsica/Hidroponia/frontend/src/context/authContext.jsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\nimport { loginRequest, registerRequest, verifyTokenRequest } from \"../api/auth\";\nimport Cookies from \"js-cookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const useAuth = () => {\n  _s();\n  const context = useContext(AuthContext);\n  if (!context) throw new Error(\"There is no AuthProvider\");\n  return context;\n};\n_s(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const useUser = () => {\n  _s2();\n  return useContext(AuthContext).getUser;\n};\n_s2(useUser, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport const AuthProvider = ({\n  children\n}) => {\n  _s3();\n  const [user, setUser] = useState(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [errors, setErrors] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const getUser = () => user;\n  useEffect(() => {\n    if (errors.length > 0) {\n      const timer = setTimeout(() => {\n        setErrors([]);\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [errors]);\n  const signup = async userData => {\n    try {\n      const res = await registerRequest(userData);\n      if (res.status === 200) {\n        const token = res.data.token;\n        localStorage.setItem(\"token\", token); // Almacena el token en localStorage\n        setUser(res.data);\n        setIsAuthenticated(true);\n      }\n    } catch (error) {\n      setErrors(error.response.data.message || []);\n    }\n  };\n  const signin = async userData => {\n    try {\n      const res = await loginRequest(userData);\n      const token = res.data.token;\n      localStorage.setItem(\"token\", token); // Almacena el token en localStorage\n      setUser(res.data.user);\n      setIsAuthenticated(true);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\"); // Elimina el token del localStorage\n    Cookies.remove(\"token\");\n    setUser(null);\n    setIsAuthenticated(false);\n  };\n  useEffect(() => {\n    const checkLogin = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        setIsAuthenticated(false);\n        setLoading(false);\n        return;\n      }\n      try {\n        const res = await verifyTokenRequest();\n        setUser(res.data.user);\n        setIsAuthenticated(true);\n        setLoading(false);\n      } catch (error) {\n        setIsAuthenticated(false);\n        setLoading(false);\n      }\n    };\n    checkLogin();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      signup,\n      signin,\n      logout,\n      isAuthenticated,\n      errors,\n      loading,\n      getUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 92,\n    columnNumber: 13\n  }, this);\n};\n_s3(AuthProvider, \"3q4iHv7c+Yco4eKq6ffm4iJD2BM=\");\n_c = AuthProvider;\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","loginRequest","registerRequest","verifyTokenRequest","Cookies","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","context","Error","useUser","_s2","getUser","AuthProvider","children","_s3","user","setUser","isAuthenticated","setIsAuthenticated","errors","setErrors","loading","setLoading","length","timer","setTimeout","clearTimeout","signup","userData","res","status","token","data","localStorage","setItem","error","response","message","signin","console","log","logout","removeItem","remove","checkLogin","getItem","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/oscar/MÃºsica/Hidroponia/frontend/src/context/authContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect} from \"react\";\nimport { loginRequest, registerRequest, verifyTokenRequest } from \"../api/auth\";\nimport Cookies from \"js-cookie\";\n\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n    const context = useContext(AuthContext);\n    if (!context) throw new Error(\"There is no AuthProvider\");\n    return context;\n};\n\nexport const useUser = () => useContext(AuthContext).getUser;\n\nexport const AuthProvider = ({ children }) => {\n    const [user, setUser] = useState(null);\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n    const [errors, setErrors] = useState([]);\n    const [loading, setLoading] = useState(true);\n\n    const getUser = () => user;\n\n    useEffect(() => {\n        if (errors.length > 0) {\n          const timer = setTimeout(() => {\n            setErrors([]);\n          }, 5000);\n          return () => clearTimeout(timer);\n        }\n      }, [errors]);\n\n      const signup = async (userData) => {\n        try {\n            const res = await registerRequest(userData);\n            if (res.status === 200) {\n                const token = res.data.token;\n                localStorage.setItem(\"token\", token); // Almacena el token en localStorage\n                setUser(res.data);\n                setIsAuthenticated(true);\n            }\n        } catch(error) {\n            setErrors(error.response.data.message || []);\n        }\n    };\n    \n\n    const signin = async (userData) => {\n        try {\n            const res = await loginRequest(userData);\n            const token = res.data.token;\n            localStorage.setItem(\"token\", token); // Almacena el token en localStorage\n            setUser(res.data.user);\n            setIsAuthenticated(true);\n        } catch (error) {\n            console.log(error)\n        }\n    };\n\n\n    const logout = () => {\n        localStorage.removeItem(\"token\"); // Elimina el token del localStorage\n        Cookies.remove(\"token\");\n        setUser(null);\n        setIsAuthenticated(false);\n    };\n\n    useEffect(() => {\n        const checkLogin = async () => {\n            const token = localStorage.getItem(\"token\");\n            if (!token) {\n                setIsAuthenticated(false);\n                setLoading(false);\n                return;\n            }\n\n            try {\n                const res = await verifyTokenRequest();\n                setUser(res.data.user);\n                setIsAuthenticated(true);\n                setLoading(false);\n            } catch (error) {\n                setIsAuthenticated(false);\n                setLoading(false);\n            }\n        };\n        checkLogin();\n        }, []);\n\n\n        return (\n            <AuthContext.Provider\n            value={{\n                user,\n                signup,\n                signin,\n                logout,\n                isAuthenticated,\n                errors,\n                loading,\n                getUser\n            }}\n            >\n                {children}\n            </AuthContext.Provider>\n    );\n};\n\nexport default AuthContext;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}